<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 900" width="1280" height="900" font-family="Segoe UI, Arial, sans-serif">
  <defs>
    <!-- Drop shadow filter -->
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="108%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <!-- Arrowhead marker -->
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4A4A4A"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0078D4"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#107C10"/>
    </marker>
    <marker id="arrow-purple" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#5C2D91"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1280" height="900" fill="#F5F5F5" rx="8"/>

  <!-- Title -->
  <text x="640" y="38" text-anchor="middle" font-size="22" font-weight="bold" fill="#1A1A1A">Agent Framework Chatbot â€” Application Architecture</text>
  <text x="640" y="58" text-anchor="middle" font-size="12" fill="#666">Deployed on Azure Kubernetes Service (AKS) â€¢ Container image: rkimacr.azurecr.io/agentframework-chatbot:v1</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- USER / BROWSER -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="40" y="85" width="160" height="100" rx="12" fill="#FFFFFF" stroke="#0078D4" stroke-width="2" filter="url(#shadow)"/>
  <text x="120" y="118" text-anchor="middle" font-size="28">ðŸ‘¤</text>
  <text x="120" y="142" text-anchor="middle" font-size="13" font-weight="bold" fill="#0078D4">User</text>
  <text x="120" y="158" text-anchor="middle" font-size="10" fill="#666">Browser</text>
  <text x="120" y="172" text-anchor="middle" font-size="10" fill="#666">Port 8501</text>

  <!-- Arrow: User â†’ Streamlit -->
  <line x1="200" y1="135" x2="268" y2="135" stroke="#0078D4" stroke-width="2" marker-end="url(#arrow-blue)"/>
  <text x="234" y="128" text-anchor="middle" font-size="9" fill="#0078D4">HTTPS</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- STREAMLIT CHATBOT UI BOX -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="270" y="75" width="310" height="200" rx="10" fill="#E8F4FD" stroke="#0078D4" stroke-width="2" filter="url(#shadow)"/>
  <text x="425" y="97" text-anchor="middle" font-size="14" font-weight="bold" fill="#0078D4">Streamlit Chatbot UI</text>
  <text x="425" y="112" text-anchor="middle" font-size="10" fill="#555">chatbot/chatbot.py</text>

  <!-- Sidebar sub-box -->
  <rect x="282" y="120" width="130" height="145" rx="6" fill="#FFFFFF" stroke="#99C9E8" stroke-width="1"/>
  <text x="347" y="138" text-anchor="middle" font-size="11" font-weight="bold" fill="#333">Sidebar Panel</text>
  <text x="347" y="155" text-anchor="middle" font-size="9" fill="#555">Agent Selector</text>
  <text x="347" y="168" text-anchor="middle" font-size="9" fill="#555">Provider (read-only)</text>
  <text x="347" y="181" text-anchor="middle" font-size="9" fill="#555">Endpoint / API Key</text>
  <text x="347" y="194" text-anchor="middle" font-size="9" fill="#555">Model Dropdown</text>
  <text x="347" y="207" text-anchor="middle" font-size="9" fill="#555">Temperature / Tokens</text>
  <text x="347" y="220" text-anchor="middle" font-size="9" fill="#555">Debug Mode â˜‘</text>
  <text x="347" y="245" text-anchor="middle" font-size="9" fill="#888">Driven by config.yaml</text>
  <text x="347" y="258" text-anchor="middle" font-size="9" fill="#888">+ .env fallback</text>

  <!-- Chat area sub-box -->
  <rect x="422" y="120" width="148" height="145" rx="6" fill="#FFFFFF" stroke="#99C9E8" stroke-width="1"/>
  <text x="496" y="138" text-anchor="middle" font-size="11" font-weight="bold" fill="#333">Chat Area</text>
  <text x="496" y="158" text-anchor="middle" font-size="9" fill="#555">Message History</text>
  <text x="496" y="171" text-anchor="middle" font-size="9" fill="#555">Response + Debug Tabs</text>
  <text x="496" y="184" text-anchor="middle" font-size="9" fill="#555">Completion Metrics</text>
  <text x="496" y="200" text-anchor="middle" font-size="9" fill="#888">st.chat_input()</text>
  <text x="496" y="213" text-anchor="middle" font-size="9" fill="#888">st.chat_message()</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- CONFIG.YAML -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="282" y="288" width="130" height="55" rx="8" fill="#FFF3E0" stroke="#F57C00" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="347" y="310" text-anchor="middle" font-size="12" font-weight="bold" fill="#E65100">âš™ config.yaml</text>
  <text x="347" y="325" text-anchor="middle" font-size="9" fill="#666">Providers Â· Agents</text>
  <text x="347" y="337" text-anchor="middle" font-size="9" fill="#666">UI settings</text>
  <!-- Arrow: config â†’ sidebar -->
  <line x1="347" y1="288" x2="347" y2="268" stroke="#F57C00" stroke-width="1.5" marker-end="url(#arrow)" stroke-dasharray="5,3"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- AGENT DISPATCH LAYER -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="620" y="75" width="280" height="200" rx="10" fill="#F3E5F5" stroke="#5C2D91" stroke-width="2" filter="url(#shadow)"/>
  <text x="760" y="97" text-anchor="middle" font-size="14" font-weight="bold" fill="#5C2D91">Agent Dispatch (main.py)</text>
  <text x="760" y="112" text-anchor="middle" font-size="10" fill="#555">Factory functions + ChatAgent</text>

  <!-- Individual agent boxes -->
  <rect x="632" y="122" width="118" height="32" rx="5" fill="#FFFFFF" stroke="#5C2D91" stroke-width="1"/>
  <text x="691" y="143" text-anchor="middle" font-size="9" font-weight="bold" fill="#5C2D91">General Chat Asst.</text>

  <rect x="758" y="122" width="132" height="32" rx="5" fill="#FFFFFF" stroke="#5C2D91" stroke-width="1"/>
  <text x="824" y="143" text-anchor="middle" font-size="9" font-weight="bold" fill="#5C2D91">Kaito Assistant</text>

  <rect x="632" y="162" width="118" height="32" rx="5" fill="#FFFFFF" stroke="#107C10" stroke-width="1.5"/>
  <text x="691" y="183" text-anchor="middle" font-size="9" font-weight="bold" fill="#107C10">KAITO RAG Asst.</text>

  <rect x="758" y="162" width="132" height="32" rx="5" fill="#FFFFFF" stroke="#5C2D91" stroke-width="1"/>
  <text x="824" y="183" text-anchor="middle" font-size="9" font-weight="bold" fill="#5C2D91">Fitness Nutrition</text>

  <rect x="632" y="202" width="118" height="32" rx="5" fill="#FFFFFF" stroke="#5C2D91" stroke-width="1"/>
  <text x="691" y="223" text-anchor="middle" font-size="9" font-weight="bold" fill="#5C2D91">Agent1 Demo</text>

  <!-- Shared utilities -->
  <rect x="758" y="202" width="132" height="55" rx="5" fill="#EDE7F6" stroke="#9575CD" stroke-width="1"/>
  <text x="824" y="218" text-anchor="middle" font-size="9" fill="#5C2D91">run_with_retry()</text>
  <text x="824" y="231" text-anchor="middle" font-size="9" fill="#5C2D91">run_with_stream()</text>
  <text x="824" y="244" text-anchor="middle" font-size="9" fill="#5C2D91">configure_logging()</text>
  <text x="824" y="254" text-anchor="middle" font-size="8" fill="#888">Exponential backoff</text>

  <!-- Arrow: Chatbot â†’ Dispatch -->
  <line x1="580" y1="165" x2="620" y2="165" stroke="#5C2D91" stroke-width="2" marker-end="url(#arrow-purple)"/>
  <text x="600" y="157" text-anchor="middle" font-size="9" fill="#5C2D91">select</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- CHAT CLIENTS LAYER -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="620" y="300" width="280" height="120" rx="10" fill="#E8F5E9" stroke="#107C10" stroke-width="2" filter="url(#shadow)"/>
  <text x="760" y="322" text-anchor="middle" font-size="14" font-weight="bold" fill="#107C10">Chat Clients (ai_chat_client.py)</text>

  <!-- AzureOpenAIChatClient -->
  <rect x="632" y="335" width="125" height="38" rx="5" fill="#FFFFFF" stroke="#0078D4" stroke-width="1.5"/>
  <text x="694" y="352" text-anchor="middle" font-size="9" font-weight="bold" fill="#0078D4">AzureOpenAI</text>
  <text x="694" y="365" text-anchor="middle" font-size="8" fill="#666">ChatClient</text>

  <!-- KaitoChatClient -->
  <rect x="765" y="335" width="125" height="38" rx="5" fill="#FFFFFF" stroke="#107C10" stroke-width="1.5"/>
  <text x="827" y="352" text-anchor="middle" font-size="9" font-weight="bold" fill="#107C10">KaitoChatClient</text>
  <text x="827" y="365" text-anchor="middle" font-size="8" fill="#666">+ extra_payload</text>

  <!-- Shared base -->
  <text x="760" y="408" text-anchor="middle" font-size="9" fill="#666">Both extend BaseChatClient (agent_framework SDK)</text>

  <!-- Arrow: Dispatch â†’ Clients -->
  <line x1="760" y1="275" x2="760" y2="298" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- BACKEND PROVIDERS (right side) -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Azure AI Foundry -->
  <rect x="960" y="85" width="280" height="105" rx="10" fill="#E3F2FD" stroke="#0078D4" stroke-width="2" filter="url(#shadow)"/>
  <text x="1100" y="108" text-anchor="middle" font-size="14" font-weight="bold" fill="#0078D4">Azure AI Foundry</text>
  <text x="1100" y="126" text-anchor="middle" font-size="10" fill="#555">Azure OpenAI Endpoint</text>
  <rect x="978" y="137" width="100" height="24" rx="4" fill="#BBDEFB" stroke="#64B5F6" stroke-width="1"/>
  <text x="1028" y="153" text-anchor="middle" font-size="9" fill="#1565C0">gpt-5.2-chat</text>
  <rect x="1086" y="137" width="100" height="24" rx="4" fill="#BBDEFB" stroke="#64B5F6" stroke-width="1"/>
  <text x="1136" y="153" text-anchor="middle" font-size="9" fill="#1565C0">DeepSeek-V3.2</text>
  <text x="1100" y="180" text-anchor="middle" font-size="9" fill="#888">Auth: API Key + AzureCliCredential</text>

  <!-- Arrow: AzureOpenAI Client â†’ AI Foundry -->
  <line x1="757" y1="354" x2="694" y2="354" stroke="none"/>
  <path d="M 694 354 Q 694 440, 900 440 Q 960 440, 960 200 Q 960 148, 958 148" fill="none" stroke="#0078D4" stroke-width="1.5" marker-end="url(#arrow-blue)" stroke-dasharray="6,3"/>
  <text x="940" y="310" text-anchor="end" font-size="9" fill="#0078D4" transform="rotate(-90,940,310)">HTTPS / REST</text>

  <!-- KAITO Inference Workspace -->
  <rect x="960" y="210" width="280" height="95" rx="10" fill="#E8F5E9" stroke="#107C10" stroke-width="2" filter="url(#shadow)"/>
  <text x="1100" y="233" text-anchor="middle" font-size="14" font-weight="bold" fill="#107C10">KAITO Inference Workspace</text>
  <text x="1100" y="250" text-anchor="middle" font-size="10" fill="#555">workspace-phi-4-mini.default.svc</text>
  <rect x="1020" y="260" width="160" height="24" rx="4" fill="#C8E6C9" stroke="#81C784" stroke-width="1"/>
  <text x="1100" y="276" text-anchor="middle" font-size="9" fill="#2E7D32">phi-4-mini-instruct</text>
  <text x="1100" y="296" text-anchor="middle" font-size="9" fill="#888">/v1/chat/completions (OpenAI-compat)</text>

  <!-- Arrow: KaitoChatClient â†’ KAITO -->
  <line x1="890" y1="354" x2="958" y2="260" stroke="#107C10" stroke-width="1.5" marker-end="url(#arrow-green)"/>
  <text x="935" y="300" text-anchor="middle" font-size="9" fill="#107C10">HTTP</text>

  <!-- KAITO RAGEngine -->
  <rect x="960" y="325" width="280" height="155" rx="10" fill="#E8F5E9" stroke="#107C10" stroke-width="2.5" filter="url(#shadow)"/>
  <text x="1100" y="348" text-anchor="middle" font-size="14" font-weight="bold" fill="#107C10">KAITO RAGEngine</text>
  <text x="1100" y="365" text-anchor="middle" font-size="10" fill="#555">ragengine-example.default.svc</text>

  <!-- Embedding model -->
  <rect x="975" y="375" width="120" height="40" rx="5" fill="#C8E6C9" stroke="#81C784" stroke-width="1"/>
  <text x="1035" y="393" text-anchor="middle" font-size="9" font-weight="bold" fill="#2E7D32">Embedding</text>
  <text x="1035" y="407" text-anchor="middle" font-size="8" fill="#555">bge-small-en-v1.5</text>

  <!-- Vector Index -->
  <rect x="1105" y="375" width="120" height="40" rx="5" fill="#FFF9C4" stroke="#FBC02D" stroke-width="1"/>
  <text x="1165" y="393" text-anchor="middle" font-size="9" font-weight="bold" fill="#F57F17">Vector Index</text>
  <text x="1165" y="407" text-anchor="middle" font-size="8" fill="#555">index_name: rag_index</text>

  <!-- Inference -->
  <rect x="1040" y="425" width="120" height="30" rx="5" fill="#C8E6C9" stroke="#81C784" stroke-width="1"/>
  <text x="1100" y="445" text-anchor="middle" font-size="9" font-weight="bold" fill="#2E7D32">phi-4-mini LLM</text>

  <!-- Internal arrows inside RAGEngine -->
  <line x1="1035" y1="415" x2="1100" y2="425" stroke="#888" stroke-width="1" marker-end="url(#arrow)"/>
  <line x1="1165" y1="415" x2="1100" y2="425" stroke="#888" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="1100" y="468" text-anchor="middle" font-size="9" fill="#888">/v1/chat/completions + index_name</text>

  <!-- Arrow: KaitoChatClient â†’ RAGEngine -->
  <line x1="890" y1="365" x2="958" y2="395" stroke="#107C10" stroke-width="2" marker-end="url(#arrow-green)"/>
  <text x="920" y="370" text-anchor="middle" font-size="9" fill="#107C10" font-weight="bold">HTTP</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- SUPPORTING SERVICES (bottom) -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Prompt Templates -->
  <rect x="40" y="310" width="175" height="60" rx="8" fill="#FFF3E0" stroke="#F57C00" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="127" y="333" text-anchor="middle" font-size="12" font-weight="bold" fill="#E65100">ðŸ“„ Prompt Templates</text>
  <text x="127" y="350" text-anchor="middle" font-size="9" fill="#666">prompts/assistant_jinja.yaml</text>
  <text x="127" y="362" text-anchor="middle" font-size="9" fill="#666">Jinja2 rendering</text>

  <!-- Config / Settings -->
  <rect x="40" y="390" width="175" height="52" rx="8" fill="#EDE7F6" stroke="#5C2D91" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="127" y="413" text-anchor="middle" font-size="12" font-weight="bold" fill="#5C2D91">âš™ config.py</text>
  <text x="127" y="428" text-anchor="middle" font-size="9" fill="#666">Settings @dataclass</text>
  <text x="127" y="438" text-anchor="middle" font-size="9" fill="#666">.env + environment vars</text>

  <!-- SQLite Store -->
  <rect x="40" y="462" width="175" height="52" rx="8" fill="#EFEBE9" stroke="#795548" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="127" y="485" text-anchor="middle" font-size="12" font-weight="bold" fill="#795548">ðŸ—„ db.py (SQLite)</text>
  <text x="127" y="500" text-anchor="middle" font-size="9" fill="#666">StructuredOutputStore</text>

  <!-- CLI -->
  <rect x="40" y="534" width="175" height="48" rx="8" fill="#E0F7FA" stroke="#0097A7" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="127" y="555" text-anchor="middle" font-size="12" font-weight="bold" fill="#006064">âŒ¨ cli.py (Click)</text>
  <text x="127" y="572" text-anchor="middle" font-size="9" fill="#666">agent1 Â· fitness commands</text>

  <!-- Arrows: Supporting â†’ Dispatch -->
  <line x1="215" y1="340" x2="630" y2="200" stroke="#888" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrow)"/>
  <line x1="215" y1="416" x2="630" y2="240" stroke="#888" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrow)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- INFRASTRUCTURE (bottom strip) -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="40" y="620" width="1200" height="120" rx="10" fill="#FFF" stroke="#0078D4" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="640" y="645" text-anchor="middle" font-size="14" font-weight="bold" fill="#0078D4">Azure Kubernetes Service (AKS) â€” Namespace: default</text>

  <!-- ACR -->
  <rect x="60" y="660" width="200" height="60" rx="6" fill="#E3F2FD" stroke="#0078D4" stroke-width="1"/>
  <text x="160" y="683" text-anchor="middle" font-size="11" font-weight="bold" fill="#0078D4">Azure Container Registry</text>
  <text x="160" y="698" text-anchor="middle" font-size="9" fill="#555">rkimacr.azurecr.io</text>
  <text x="160" y="710" text-anchor="middle" font-size="9" fill="#555">agentframework-chatbot:v1</text>

  <!-- Chatbot Deployment -->
  <rect x="280" y="660" width="200" height="60" rx="6" fill="#E8F5E9" stroke="#107C10" stroke-width="1"/>
  <text x="380" y="683" text-anchor="middle" font-size="11" font-weight="bold" fill="#107C10">Chatbot Deployment</text>
  <text x="380" y="698" text-anchor="middle" font-size="9" fill="#555">Pod: Streamlit + agents</text>
  <text x="380" y="710" text-anchor="middle" font-size="9" fill="#555">Port 8501</text>

  <!-- KAITO Workspace Pod -->
  <rect x="500" y="660" width="200" height="60" rx="6" fill="#E8F5E9" stroke="#107C10" stroke-width="1"/>
  <text x="600" y="683" text-anchor="middle" font-size="11" font-weight="bold" fill="#107C10">KAITO Workspace Pod</text>
  <text x="600" y="698" text-anchor="middle" font-size="9" fill="#555">phi-4-mini-instruct</text>
  <text x="600" y="710" text-anchor="middle" font-size="9" fill="#555">GPU node</text>

  <!-- RAGEngine Pod -->
  <rect x="720" y="660" width="200" height="60" rx="6" fill="#E8F5E9" stroke="#107C10" stroke-width="1.5"/>
  <text x="820" y="683" text-anchor="middle" font-size="11" font-weight="bold" fill="#107C10">RAGEngine Pod</text>
  <text x="820" y="698" text-anchor="middle" font-size="9" fill="#555">bge-small + vector index</text>
  <text x="820" y="710" text-anchor="middle" font-size="9" fill="#555">â†’ phi-4-mini inference</text>

  <!-- K8s Services -->
  <rect x="940" y="660" width="280" height="60" rx="6" fill="#FFF3E0" stroke="#F57C00" stroke-width="1"/>
  <text x="1080" y="680" text-anchor="middle" font-size="10" font-weight="bold" fill="#E65100">K8s ClusterIP Services</text>
  <text x="1080" y="695" text-anchor="middle" font-size="8" fill="#555">workspace-phi-4-mini.default.svc:80</text>
  <text x="1080" y="708" text-anchor="middle" font-size="8" fill="#555">ragengine-example.default.svc:80</text>

  <!-- Arrows within infra -->
  <line x1="260" y1="690" x2="278" y2="690" stroke="#0078D4" stroke-width="1" marker-end="url(#arrow-blue)"/>
  <line x1="480" y1="690" x2="498" y2="690" stroke="#107C10" stroke-width="1" marker-end="url(#arrow-green)"/>
  <line x1="700" y1="690" x2="718" y2="690" stroke="#107C10" stroke-width="1" marker-end="url(#arrow-green)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- DATA FLOW LEGEND -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="40" y="760" width="600" height="120" rx="8" fill="#FFFFFF" stroke="#CCC" stroke-width="1"/>
  <text x="60" y="783" font-size="12" font-weight="bold" fill="#333">Data Flow</text>

  <text x="60" y="803" font-size="10" fill="#333">1.</text>
  <text x="75" y="803" font-size="10" fill="#333">User selects agent in sidebar â†’ config.yaml resolves provider/model/endpoint</text>

  <text x="60" y="820" font-size="10" fill="#333">2.</text>
  <text x="75" y="820" font-size="10" fill="#333">User types prompt â†’ chatbot.py dispatches to matching agent factory function</text>

  <text x="60" y="837" font-size="10" fill="#333">3.</text>
  <text x="75" y="837" font-size="10" fill="#333">Factory builds ChatAgent with appropriate ChatClient (Azure OpenAI or KAITO)</text>

  <text x="60" y="854" font-size="10" fill="#333">4.</text>
  <text x="75" y="854" font-size="10" fill="#333">ChatClient sends HTTP POST /v1/chat/completions to backend provider</text>

  <text x="60" y="871" font-size="10" fill="#333">5.</text>
  <text x="75" y="871" font-size="10" fill="#333">RAGEngine: embed query (bge-small) â†’ vector search â†’ context + prompt â†’ phi-4-mini â†’ response</text>

  <!-- Legend symbols -->
  <rect x="680" y="770" width="540" height="110" rx="8" fill="#FFFFFF" stroke="#CCC" stroke-width="1"/>
  <text x="700" y="793" font-size="12" font-weight="bold" fill="#333">Legend</text>

  <line x1="700" y1="810" x2="740" y2="810" stroke="#0078D4" stroke-width="2"/>
  <text x="750" y="814" font-size="10" fill="#333">Azure AI Foundry path</text>

  <line x1="700" y1="830" x2="740" y2="830" stroke="#107C10" stroke-width="2"/>
  <text x="750" y="834" font-size="10" fill="#333">KAITO / RAGEngine path</text>

  <line x1="700" y1="850" x2="740" y2="850" stroke="#888" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="750" y="854" font-size="10" fill="#333">Internal dependency</text>

  <line x1="700" y1="868" x2="740" y2="868" stroke="#F57C00" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="750" y="872" font-size="10" fill="#333">Config-driven binding</text>

  <rect x="920" y="803" width="14" height="14" rx="2" fill="#E3F2FD" stroke="#0078D4" stroke-width="1"/>
  <text x="942" y="814" font-size="10" fill="#333">Azure service</text>

  <rect x="920" y="823" width="14" height="14" rx="2" fill="#E8F5E9" stroke="#107C10" stroke-width="1"/>
  <text x="942" y="834" font-size="10" fill="#333">KAITO/K8s component</text>

  <rect x="920" y="843" width="14" height="14" rx="2" fill="#FFF3E0" stroke="#F57C00" stroke-width="1"/>
  <text x="942" y="854" font-size="10" fill="#333">Configuration</text>

  <rect x="920" y="863" width="14" height="14" rx="2" fill="#F3E5F5" stroke="#5C2D91" stroke-width="1"/>
  <text x="942" y="874" font-size="10" fill="#333">Agent framework</text>
</svg>
